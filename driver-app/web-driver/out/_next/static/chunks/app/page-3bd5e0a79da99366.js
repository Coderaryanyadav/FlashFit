(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{626:function(e,t,s){Promise.resolve().then(s.bind(s,4398))},4398:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return P}});var r=s(7573),i=s(7653),n=s(2876),l=s(5991),a=s(1897),d=s(6076),o=s(6273),c=s(7598),x=s(4118),u=s(4038),m=s(6968),h=s(8348),g=s(4399),p=s(7323),b=s(6308),f=s(6771),v=s(6227),j=s(2424),y=s(7456),w=s(2301),N=s(1695),k=s(756),z=s(75),S=s(294),A=s(9209),C=s(7779);function O(e){let{open:t,onOpenChange:s,children:i}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:(0,r.jsxs)("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl shadow-2xl max-w-md w-full relative overflow-hidden animate-in zoom-in-95 duration-200",children:[(0,r.jsx)("button",{className:"absolute top-4 right-4 text-zinc-400 hover:text-white transition-colors",onClick:()=>s(!1),children:(0,r.jsx)(A.Z,{className:"h-5 w-5"})}),i]})}):null}function D(e){let{children:t,className:s}=e;return(0,r.jsx)("div",{className:(0,C.cn)("p-6",s),children:t})}function I(e){let{children:t,className:s}=e;return(0,r.jsx)("div",{className:(0,C.cn)("mb-4",s),children:t})}function E(e){let{children:t,className:s}=e;return(0,r.jsx)("h2",{className:(0,C.cn)("text-xl font-bold text-white",s),children:t})}function _(e){let{children:t,className:s}=e;return(0,r.jsx)("p",{className:(0,C.cn)("text-sm text-gray-400 mt-1",s),children:t})}function F(e){let{children:t,className:s}=e;return(0,r.jsx)("div",{className:(0,C.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 mt-6",s),children:t})}var Z=s(7787);function P(){var e,t,A,C,P,U,M,J,T;let[L,B]=(0,i.useState)(null),[R,q]=(0,i.useState)(!0),[G,W]=(0,i.useState)(!1),[Y,Q]=(0,i.useState)([]),[H,K]=(0,i.useState)({earnings:0,deliveries:0,onlineSince:null,todayOnlineMinutes:0,lastSeen:null}),[V,X]=(0,i.useState)(0),[$,ee]=(0,i.useState)(!1),[et,es]=(0,i.useState)([]),[er,ei]=(0,i.useState)(!1),[en,el]=(0,i.useState)(!1),[ea,ed]=(0,i.useState)(""),eo=(0,N.useRouter)(),{activeOrder:ec,updateStatus:ex}=function(e){let[t,r]=(0,i.useState)(null),[n,d]=(0,i.useState)(!0);(0,i.useEffect)(()=>{if(!e){d(!1);return}let t=(0,a.IO)((0,a.hJ)(l.db,"orders"),(0,a.ar)("driverId","==",e.uid),(0,a.ar)("status","in",["assigned","picked_up","delivered","returning","warehouse_reached"])),s=(0,a.cf)(t,e=>{if(e.empty)r(null);else{let t=e.docs[0];r({id:t.id,...t.data()})}d(!1)});return()=>s()},[e]);let o=async r=>{if(t&&e)try{let{httpsCallable:e,getFunctions:i}=await Promise.resolve().then(s.bind(s,6076)),{app:n}=await Promise.resolve().then(s.bind(s,5991)),l=i(n),a=e(l,"updateOrderStatus");await a({orderId:t.id,status:r})}catch(e){throw console.error("Error updating status:",e),e}};return{activeOrder:t,loading:n,updateStatus:o}}(L),eu=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;"undefined"!=typeof navigator&&navigator.vibrate&&navigator.vibrate(e)};(0,i.useEffect)(()=>{let e=(0,n.Aj)(l.I8,e=>{e?B(e):eo.push("/login"),q(!1)});return()=>e()},[eo]),(0,i.useEffect)(()=>{if(!L)return;let e=(0,a.JU)(l.db,"drivers",L.uid),t=(0,a.cf)(e,e=>{if(e.exists()){var t,s;let r=e.data();console.log("Driver data from Firestore:",r),W(!0===r.isOnline),K({earnings:r.totalEarnings||0,deliveries:r.totalDeliveries||0,onlineSince:(null===(t=r.onlineSince)||void 0===t?void 0:t.toDate())||null,todayOnlineMinutes:r.todayOnlineMinutes||0,lastSeen:(null===(s=r.lastSeen)||void 0===s?void 0:s.toDate())||null})}else console.log("Driver document does not exist")},e=>{console.error("Error syncing driver status:",e)});return()=>t()},[L]),(0,i.useEffect)(()=>{if(!G||!H.onlineSince){X(0);return}let e=()=>{let e=new Date;X((e.getTime()-H.onlineSince.getTime())/1e3/60),H.onlineSince&&(H.onlineSince.getDate(),e.getDate())};e();let t=setInterval(e,6e4);return()=>clearInterval(t)},[G,H.onlineSince]);let em=async()=>{if(!L)return;eu(50);let e=!G;console.log("Toggling online status from",G,"to",e);try{let t={isOnline:e,status:e?"online":"offline",lastSeen:(0,a.Bt)()};if(e){t.onlineSince=(0,a.Bt)();let e=H.lastSeen||new Date(0),s=new Date;(e.getDate()!==s.getDate()||e.getMonth()!==s.getMonth()||e.getFullYear()!==s.getFullYear())&&(t.todayOnlineMinutes=0,console.log("New day detected, resetting todayOnlineMinutes"))}else if(H.onlineSince){let e=(new Date().getTime()-H.onlineSince.getTime())/1e3/60;t.todayOnlineMinutes=(0,a.nP)(e),t.onlineSince=null}console.log("Updating driver document with:",t),await (0,a.r7)((0,a.JU)(l.db,"drivers",L.uid),t),console.log("Driver document updated successfully"),e&&navigator.geolocation?navigator.geolocation.getCurrentPosition(async e=>{await (0,a.pl)((0,a.JU)(l.db,"driverLocations",L.uid),{driverId:L.uid,driverName:L.displayName||L.email||"Driver",latitude:e.coords.latitude,longitude:e.coords.longitude,status:"online",lastUpdated:(0,a.Bt)()},{merge:!0})},e=>{console.error("Location error:",e),alert("Please enable location access to go online")}):e||await (0,a.pl)((0,a.JU)(l.db,"driverLocations",L.uid),{status:"offline",lastUpdated:(0,a.Bt)()},{merge:!0})}catch(e){console.error("Error toggling status:",e),Z.A.error("Failed to update status. Please try again.")}};(0,i.useEffect)(()=>{if(!G||!L)return;let e=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(async e=>{try{await (0,a.pl)((0,a.JU)(l.db,"driverLocations",L.uid),{driverId:L.uid,driverName:L.displayName||L.email||"Driver",latitude:e.coords.latitude,longitude:e.coords.longitude,status:"online",lastUpdated:(0,a.Bt)()},{merge:!0})}catch(e){console.error("Error updating location:",e)}},e=>console.error("Location error:",e))};e();let t=setInterval(e,1e4);return()=>clearInterval(t)},[G,L]),(0,i.useEffect)(()=>{if(!G||!L){Q([]);return}let e=(0,a.IO)((0,a.hJ)(l.db,"orders"),(0,a.ar)("status","in",["placed","pending","confirmed"])),t=(0,a.cf)(e,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));Q(e=>(t.length>e.length&&eu([50,50,50]),t))});return()=>t()},[G,L]);let eh=async e=>{if(L){eu(20);try{let t=(0,a.JU)(l.db,"orders",e.id);await (0,a.i3)(l.db,async e=>{let s=await e.get(t);if(!s.exists())throw"Order does not exist!";let r=s.data();if("placed"!==r.status&&"pending"!==r.status&&"confirmed"!==r.status)throw"Order is no longer available.";let i=(0,a.JU)(l.db,"drivers",L.uid),n=await e.get(i),d=n.exists()?n.data():{};e.update(t,{status:"assigned",driverId:L.uid,driverName:L.displayName||"Driver",driverPhone:d.phone||L.phoneNumber||"",updatedAt:(0,a.Bt)()})}),Q(t=>t.filter(t=>t.id!==e.id)),eu([50,100,50])}catch(e){console.error("Error accepting order:",e),Z.A.error("Failed: "+(e.message||e))}}},eg=async e=>{if(ec&&L){eu(20);try{await ex(e),eu(50)}catch(t){console.error("Error updating status to ".concat(e,":"),t),Z.A.error("Failed to update status.")}}},ep=()=>{if(!(null==ec?void 0:ec.items)){eg("delivered");return}es(ec.items.map(e=>e.id||e.productId)),ee(!0)},eb=async()=>{if(ec&&L){ei(!0),eu(20);try{let e=(0,d.httpsCallable)(l.wk,"completeOrder");await e({orderId:ec.id,otp:ea,deliveredItemIds:et}),ee(!1),ed(""),eu([100,50,100]),Z.A.success("Delivery confirmed successfully!")}catch(e){console.error("Error confirming delivery:",e),Z.A.error("Failed to confirm delivery: ".concat(e.message))}finally{ei(!1)}}},ef=async()=>{if(ec&&L){ei(!0);try{await ex("delivered"),ee(!1),Z.A.success("Force completed successfully. Note: Stock/Payment may not be updated."),eu([100,50,100])}catch(e){console.error("Error force completing:",e),Z.A.error("Failed to force complete.")}finally{ei(!1)}}},ev=(()=>{if(!ec)return null;switch(ec.status){case"assigned":return{label:"Pick Up Order",action:()=>eg("picked_up"),disabled:!1,style:"bg-white text-black hover:bg-gray-200"};case"picked_up":return{label:"Complete Delivery",action:()=>ep(),disabled:!1,style:"bg-green-500 text-white hover:bg-green-600"};case"delivered":return{label:"Return to Warehouse",action:()=>eg("returning"),disabled:!1,style:"bg-yellow-500 text-black hover:bg-yellow-600"};case"returning":return{label:"Check In at Warehouse",action:()=>eg("warehouse_reached"),disabled:!1,style:"bg-blue-500 text-white hover:bg-blue-600"};case"warehouse_reached":return{label:"Waiting for Approval",action:()=>{},disabled:!0,style:"bg-zinc-700 text-zinc-400 cursor-not-allowed"};default:return{label:"Unknown Status",action:()=>{},disabled:!0,style:"bg-gray-500"}}})(),ej=(e,t)=>{window.open("https://www.google.com/maps/dir/?api=1&destination=".concat(e,",").concat(t),"_blank")};return R?(0,r.jsxs)("div",{className:"flex h-screen items-center justify-center bg-black text-white flex-col gap-4",children:[(0,r.jsx)(c.Z,{className:"h-8 w-8 animate-spin text-green-500"}),(0,r.jsx)("p",{className:"text-gray-400 animate-pulse font-medium",children:"Loading Driver App..."})]}):L?(0,r.jsxs)("div",{className:"min-h-screen bg-black text-white pb-24 font-sans selection:bg-green-500 selection:text-black",children:[(0,r.jsx)("header",{className:"fixed top-0 inset-x-0 z-50 bg-black/80 backdrop-blur-md border-b border-white/10 p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between max-w-md mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"h-10 w-10 bg-zinc-900 border border-zinc-700 rounded-full flex items-center justify-center shadow-[0_0_15px_rgba(255,255,255,0.1)]",children:(0,r.jsx)("span",{className:"text-white font-black text-lg",children:"D"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"font-bold text-lg leading-none",children:"FlashFit Driver"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(G?"bg-green-500 animate-pulse shadow-[0_0_10px_#22c55e]":"bg-red-500")}),(0,r.jsx)("span",{className:"text-xs text-gray-400 font-medium uppercase tracking-wider",children:G?"Online":"Offline"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-zinc-900 rounded-full px-4 py-2 border border-zinc-800",children:[(0,r.jsx)(x.Z,{className:"h-4 w-4 text-green-400"}),(0,r.jsx)("span",{className:"text-sm font-bold",children:H.earnings})]})]})}),(0,r.jsx)("main",{className:"pt-32 px-4 max-w-md mx-auto",children:G?(0,r.jsxs)("div",{className:"space-y-6",children:[!ec&&(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-zinc-900/50 border border-zinc-800 p-5 rounded-3xl hover:bg-zinc-900 transition-colors",children:[(0,r.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-500/20 flex items-center justify-center mb-3",children:(0,r.jsx)(m.Z,{className:"h-5 w-5 text-blue-400"})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wider",children:"Deliveries"}),(0,r.jsx)("p",{className:"text-3xl font-bold mt-1 text-white",children:H.deliveries})]}),(0,r.jsxs)("div",{className:"bg-zinc-900/50 border border-zinc-800 p-5 rounded-3xl hover:bg-zinc-900 transition-colors",children:[(0,r.jsx)("div",{className:"h-10 w-10 rounded-full bg-purple-500/20 flex items-center justify-center mb-3",children:(0,r.jsx)(h.Z,{className:"h-5 w-5 text-purple-400"})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wider",children:"Online Hours"}),(0,r.jsx)("p",{className:"text-3xl font-bold mt-1 text-white",children:((H.todayOnlineMinutes+V)/60).toFixed(1)})]})]}),!ec&&(0,r.jsxs)("button",{onClick:em,className:"w-full bg-red-500/10 hover:bg-red-500/20 border border-red-500/30 text-red-400 font-bold py-4 rounded-2xl transition-all flex items-center justify-center gap-2 active:scale-95",children:[(0,r.jsx)(u.Z,{className:"h-5 w-5"}),"GO OFFLINE"]}),(0,r.jsx)(z.M,{mode:"wait",children:ec?(0,r.jsxs)(k.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-zinc-900 border-2 border-green-500/50 rounded-[2rem] overflow-hidden shadow-[0_0_60px_rgba(34,197,94,0.3)] relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-green-500/10 to-transparent pointer-events-none"}),(0,r.jsxs)("div",{className:"bg-green-600 px-6 py-4 flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"font-bold text-white flex items-center gap-2",children:[(0,r.jsx)(g.Z,{className:"h-5 w-5"})," Current Delivery"]}),(0,r.jsx)("span",{className:"text-xs font-bold bg-black/20 px-3 py-1 rounded-full text-white backdrop-blur-sm",children:"EST. 15 MIN"})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-start gap-4 pb-6 border-b border-white/5",children:[(0,r.jsx)("div",{className:"h-14 w-14 rounded-2xl bg-zinc-800 flex items-center justify-center shrink-0 border border-zinc-700",children:(0,r.jsx)(p.Z,{className:"h-7 w-7 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider mb-0.5",children:"Pickup From"}),(0,r.jsx)("h3",{className:"text-xl font-bold text-white mb-1",children:ec.storeName||"FlashFit Store"}),(0,r.jsx)("p",{className:"text-gray-400 leading-tight text-sm",children:ec.pickupAddress||"Goregaon, Mumbai"})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:"h-14 w-14 rounded-2xl bg-zinc-800 flex items-center justify-center shrink-0 border border-zinc-700",children:(0,r.jsx)(b.Z,{className:"h-7 w-7 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white mb-1",children:(null===(e=ec.shippingAddress)||void 0===e?void 0:e.name)||"Customer"}),(0,r.jsxs)("p",{className:"text-gray-400 leading-tight text-sm",children:[null===(t=ec.shippingAddress)||void 0===t?void 0:t.street,", ",null===(A=ec.shippingAddress)||void 0===A?void 0:A.city]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 bg-black/40 rounded-2xl p-2 pr-4 border border-white/5",children:[(0,r.jsx)(o.z,{size:"icon",variant:"ghost",className:"h-12 w-12 rounded-xl text-white hover:bg-zinc-800",onClick:()=>{var e;return window.open("tel:".concat((null===(e=ec.shippingAddress)||void 0===e?void 0:e.phone)||ec.customerPhone),"_self")},children:(0,r.jsx)(f.Z,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider",children:"Contact"}),(0,r.jsx)("p",{className:"font-bold text-sm",children:null===(C=ec.shippingAddress)||void 0===C?void 0:C.phone})]}),(0,r.jsxs)(o.z,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white rounded-full px-6 h-10 font-bold shadow-lg shadow-blue-900/20",onClick:()=>{var e;return(null===(e=ec.shippingAddress)||void 0===e?void 0:e.location)&&ej(ec.shippingAddress.location.lat,ec.shippingAddress.location.lng)},children:[(0,r.jsx)(g.Z,{className:"h-4 w-4 mr-2"})," Navigate"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 py-2",children:[(0,r.jsxs)("div",{className:"bg-zinc-800/50 rounded-xl p-3",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Amount"}),(0,r.jsxs)("p",{className:"text-lg font-bold",children:["₹",ec.totalAmount]})]}),(0,r.jsxs)("div",{className:"bg-zinc-800/50 rounded-xl p-3",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Items"}),(0,r.jsxs)("p",{className:"text-lg font-bold",children:[(null===(P=ec.items)||void 0===P?void 0:P.length)||1," items"]})]})]}),(0,r.jsxs)("div",{className:"bg-zinc-800/30 rounded-2xl border border-white/5 overflow-hidden",children:[(0,r.jsxs)("button",{onClick:()=>el(!en),className:"w-full flex items-center justify-between p-4 text-sm font-bold text-gray-300 hover:bg-white/5 transition-colors",children:[(0,r.jsx)("span",{children:"Order Items"}),en?(0,r.jsx)(v.Z,{className:"h-4 w-4"}):(0,r.jsx)(j.Z,{className:"h-4 w-4"})]}),en&&(0,r.jsx)("div",{className:"p-4 pt-0 space-y-3",children:null===(U=ec.items)||void 0===U?void 0:U.map((e,t)=>(0,r.jsxs)("div",{className:"flex gap-3 items-center bg-black/20 p-2 rounded-lg",children:[(0,r.jsx)("div",{className:"h-10 w-10 bg-zinc-800 rounded-md flex items-center justify-center shrink-0 relative overflow-hidden",children:e.image?(0,r.jsx)(S.default,{src:e.image,alt:e.title,fill:!0,className:"object-cover"}):(0,r.jsx)(m.Z,{className:"h-5 w-5 text-gray-500"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white truncate",children:e.title}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Qty: ",e.quantity," • ₹",e.price]})]})]},t))})]}),ev&&(0,r.jsx)(o.z,{onClick:ev.action,disabled:ev.disabled,className:"w-full font-bold h-16 text-lg rounded-2xl shadow-xl transition-transform active:scale-95 ".concat(ev.style),children:ev.label})]})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,r.jsx)("h2",{className:"font-bold text-xl text-white",children:"Available Orders"}),(0,r.jsxs)("span",{className:"text-xs font-bold bg-zinc-800 text-gray-400 px-2 py-1 rounded-md border border-zinc-700",children:[Y.length," NEARBY"]})]}),0===Y.length?(0,r.jsxs)("div",{className:"py-24 flex flex-col items-center justify-center text-center space-y-6 opacity-50",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-blue-500/20 blur-2xl rounded-full animate-pulse"}),(0,r.jsx)("div",{className:"h-24 w-24 bg-zinc-900 rounded-full flex items-center justify-center relative z-10 border border-zinc-800 shadow-xl",children:(0,r.jsx)(g.Z,{className:"h-10 w-10 text-blue-400 animate-spin-slow"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold text-lg text-white",children:"Scanning Area..."}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Finding orders near your location"})]})]}):(0,r.jsx)("div",{className:"space-y-4 pb-24",children:Y.map(e=>{var t,s;return(0,r.jsxs)(k.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-zinc-900 border border-zinc-800 p-5 rounded-3xl active:scale-[0.98] transition-transform touch-manipulation shadow-lg relative overflow-hidden group",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"bg-blue-500/10 text-blue-400 border border-blue-500/20 text-[10px] font-bold px-2 py-1 rounded-md uppercase tracking-wider animate-pulse",children:"New Request"}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"Just now"})]}),(0,r.jsxs)("span",{className:"text-xl font-black text-green-400",children:["₹",e.totalAmount]})]}),(0,r.jsxs)("div",{className:"flex gap-4 mb-6 relative z-10",children:[(0,r.jsx)("div",{className:"absolute left-[11px] top-3 bottom-3 w-0.5 bg-zinc-800"}),(0,r.jsxs)("div",{className:"flex flex-col gap-8 z-10",children:[(0,r.jsx)("div",{className:"h-6 w-6 rounded-full bg-zinc-800 border-4 border-black flex items-center justify-center",children:(0,r.jsx)("div",{className:"h-2 w-2 rounded-full bg-gray-500"})}),(0,r.jsx)("div",{className:"h-6 w-6 rounded-full bg-white border-4 border-black flex items-center justify-center",children:(0,r.jsx)("div",{className:"h-2 w-2 rounded-full bg-black"})})]}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider mb-0.5",children:"Pickup"}),(0,r.jsx)("p",{className:"font-medium text-sm text-gray-300",children:e.storeName||"FlashFit Store"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.pickupAddress||"Goregaon, Mumbai"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider mb-0.5",children:"Dropoff"}),(0,r.jsx)("p",{className:"font-bold text-white text-lg leading-tight",children:(null===(t=e.shippingAddress)||void 0===t?void 0:t.city)||"Customer Location"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 truncate mt-1",children:(null===(s=e.shippingAddress)||void 0===s?void 0:s.pincode)||"Area details hidden"})]})]})]}),(0,r.jsx)(o.z,{onClick:()=>eh(e),className:"w-full bg-white text-black hover:bg-gray-200 font-bold h-14 rounded-2xl text-lg shadow-lg transition-transform active:scale-95 relative z-10",children:"Accept Order"})]},e.id)})})]})})]}):(0,r.jsxs)(k.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex flex-col items-center justify-center py-20 space-y-8",children:[(0,r.jsxs)("div",{className:"relative group cursor-pointer",onClick:em,children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-green-500/20 blur-3xl rounded-full group-hover:bg-green-500/30 transition-all duration-500 animate-pulse"}),(0,r.jsxs)("div",{className:"relative h-44 w-44 rounded-full bg-white text-black flex flex-col items-center justify-center gap-2 shadow-[0_0_50px_rgba(255,255,255,0.2)] hover:scale-105 transition-transform duration-300 border-4 border-green-500/10",children:[(0,r.jsx)(u.Z,{className:"h-14 w-14 text-green-600"}),(0,r.jsx)("span",{className:"font-black text-2xl tracking-tight",children:"GO ONLINE"})]})]}),(0,r.jsx)("p",{className:"text-gray-400 text-center max-w-xs text-lg",children:"Tap to start receiving delivery requests in your area."})]})}),(0,r.jsx)(O,{open:$,onOpenChange:ee,children:(0,r.jsxs)(D,{className:"bg-zinc-900 border-zinc-800 text-white sm:max-w-md",children:[(0,r.jsxs)(I,{children:[(0,r.jsx)(E,{className:"text-xl font-bold",children:"Confirm Delivery"}),(0,r.jsx)(_,{className:"text-gray-400",children:"Select items delivered. Unselected items will be marked as returned."})]}),(0,r.jsxs)("div",{className:"py-4 space-y-4 max-h-[60vh] overflow-y-auto overscroll-contain touch-pan-y",children:[null==ec?void 0:null===(M=ec.items)||void 0===M?void 0:M.map((e,t)=>{let s=e.id||e.productId,i=et.includes(s);return(0,r.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-xl border transition-all cursor-pointer ".concat(i?"bg-green-500/10 border-green-500/50":"bg-zinc-800 border-zinc-700"),onClick:()=>{i?es(e=>e.filter(e=>e!==s)):es(e=>[...e,s])},children:[(0,r.jsx)("div",{className:"h-6 w-6 rounded-full border-2 flex items-center justify-center transition-colors ".concat(i?"bg-green-500 border-green-500":"border-gray-500"),children:i&&(0,r.jsx)(y.Z,{className:"h-4 w-4 text-black"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-bold text-sm",children:e.title}),(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:["Qty: ",e.quantity," • ₹",e.price]})]}),!i&&(0,r.jsx)("span",{className:"text-xs font-bold text-yellow-500 bg-yellow-500/10 px-2 py-1 rounded",children:"RETURN"})]},t)}),et.length!==(null==ec?void 0:null===(J=ec.items)||void 0===J?void 0:J.length)&&(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-xl text-yellow-500 text-sm",children:[(0,r.jsx)(w.Z,{className:"h-4 w-4"}),(0,r.jsxs)("span",{children:[(null==ec?void 0:null===(T=ec.items)||void 0===T?void 0:T.length)-et.length," items will be marked as returned."]})]}),(0,r.jsxs)("div",{className:"space-y-2 pt-4 border-t border-white/10",children:[(0,r.jsx)("label",{className:"text-sm font-bold text-gray-400",children:"Customer OTP"}),(0,r.jsx)("input",{type:"text",maxLength:6,placeholder:"Enter 6-digit OTP",value:ea,onChange:e=>ed(e.target.value.replace(/\D/g,"")),className:"w-full bg-black border border-zinc-700 rounded-xl px-4 py-3 text-center text-2xl font-bold tracking-widest focus:outline-none focus:border-green-500 transition-colors"}),(0,r.jsx)("p",{className:"text-xs text-center text-gray-500",children:"Ask customer for OTP to complete delivery"})]})]}),(0,r.jsxs)(F,{className:"gap-2 sm:gap-0 flex-col sm:flex-row",children:[(0,r.jsxs)("div",{className:"flex gap-2 w-full sm:w-auto",children:[(0,r.jsx)(o.z,{variant:"ghost",onClick:()=>ee(!1),className:"text-gray-400 hover:text-white hover:bg-zinc-800 flex-1 sm:flex-none",children:"Cancel"}),(0,r.jsx)(o.z,{variant:"destructive",onClick:ef,disabled:er,className:"bg-red-900/20 text-red-500 hover:bg-red-900/40 border border-red-900/50 flex-1 sm:flex-none",children:"Force Complete"})]}),(0,r.jsx)(o.z,{onClick:eb,disabled:er,className:"bg-green-500 text-black hover:bg-green-600 font-bold w-full sm:w-auto",children:er?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}):"Confirm & Complete"})]})]})})]}):null}},6273:function(e,t,s){"use strict";s.d(t,{z:function(){return o}});var r=s(7573),i=s(7653),n=s(5814),l=s(9289),a=s(7779);let d=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=i.forwardRef((e,t)=>{let{className:s,variant:i,size:l,asChild:o=!1,...c}=e,x=o?n.g7:"button";return(0,r.jsx)(x,{className:(0,a.cn)(d({variant:i,size:l,className:s})),ref:t,...c})});o.displayName="Button"},7779:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var r=s(607),i=s(5579);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,i.m6)((0,r.W)(t))}},5991:function(e,t,s){"use strict";s.d(t,{I8:function(){return c},app:function(){return d},db:function(){return o},wk:function(){return x}});var r=s(791),i=s(2876),n=s(1897),l=s(4362),a=s(6076);let d=0===(0,r.C6)().length?(0,r.ZF)({apiKey:"AIzaSyCcO8q6G08EPk047pncwT0UdJLiDB3WJ6I",authDomain:"studio-847805730-4f392.firebaseapp.com",projectId:"studio-847805730-4f392",storageBucket:"studio-847805730-4f392.firebasestorage.app",messagingSenderId:"497323679456",appId:"1:497323679456:web:fef3f0e6e3af943969ba85"}):(0,r.C6)()[0],o=(0,n.ad)(d),c=(0,i.v0)(d);(0,l.cF)(d);let x=(0,a.getFunctions)(d)}},function(e){e.O(0,[301,139,228,366,525,357,168,293,528,744],function(){return e(e.s=626)}),_N_E=e.O()}]);